<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>{% block title %}My Flask Site{% endblock %}</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tangerine:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-messages">
      {% for category, message in messages %}
        <div class="flash flash-{{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<nav style="display:flex; justify-content: space-between; padding: 10px; background: #eee;">
  <div class="nav-left">
    <a href="{{ url_for('home') }}">Home</a>
    <a href="{{ url_for('products_page') }}">Products</a>
  </div>
  <div class="nav-right" style="display:flex; align-items:center; gap: 15px; position: relative;">
    <a href="{{ url_for('cart') }}">My Cart ({{ cart_item_count }})</a>
    <a href="{{ url_for('register') }}">Register</a>
    <a href="{{ url_for('about') }}">About Us</a>
<button id="theme-toggle" style="margin-left: 20px;">ðŸŒ“</button>

    <div class="nav-signin" style="position: relative;">
      {% if session.get('user') %}
        <span>Welcome, {{ session.get('user') }}</span>
        <a href="{{ url_for('logout') }}" style="margin-left: 10px;">Logout</a>
      {% else %}
        <button id="signin-btn" type="button" style="cursor:pointer; padding: 5px 10px;">
          Sign In â–¼
        </button>

        <div id="signin-dropdown" style="
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            width: 260px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
          ">
          <form method="POST" action="{{ url_for('login') }}">
            <label for="username">Username</label><br>
            <input type="text" id="username" name="username" required style="width: 100%; padding: 5px; margin-bottom: 10px;"><br>

            <label for="password">Password</label><br>
            <input type="password" id="password" name="password" required style="width: 100%; padding: 5px; margin-bottom: 10px;"><br>

            <button type="submit" style="width: 100%; padding: 7px; background-color: #007bff; color: white; border: none; cursor: pointer;">
              Sign In
            </button>

            <div style="margin-top: 10px; font-size: 0.9em;">
              <a href="{{ url_for('register') }}">Register</a> |
              <a href="{{ url_for('signin') }}">Forgot password?</a>
            </div>
          </form>
        </div>
      {% endif %}
    </div>
  </div>
</nav>

<div class="content">
    {% block content %}{% endblock %}
</div>

<script>
  const signinBtn = document.getElementById('signin-btn');
  const signinDropdown = document.getElementById('signin-dropdown');

  signinBtn.addEventListener('click', () => {
    if (signinDropdown.style.display === 'none' || signinDropdown.style.display === '') {
      signinDropdown.style.display = 'block';
    } else {
      signinDropdown.style.display = 'none';
    }
  });

  // Hide dropdown if clicking outside
  window.addEventListener('click', (e) => {
    if (!signinBtn.contains(e.target) && !signinDropdown.contains(e.target)) {
      signinDropdown.style.display = 'none';
    }
  });
</script>

<script>
  const hero = document.getElementById("hero-banner");
  const images = [
    "/static/images/heroimage1.jpg",
    "/static/images/heroimage2.jpg",
    "/static/images/heroimage3.jpg"
  ];
  let index = 0;

  function changeHeroBackground() {
    hero.style.backgroundImage = `url('${images[index]}')`;
    index = (index + 1) % images.length;
  }

  changeHeroBackground(); // Initial image
  setInterval(changeHeroBackground, 10000); // Change every 5 seconds
</script>

<script>
  const toggleBtn = document.getElementById("theme-toggle");
  const body = document.body;

  // Load saved theme on page load
  if (localStorage.getItem("theme") === "dark") {
    body.classList.add("dark-mode");
  }

  toggleBtn.addEventListener("click", () => {
    body.classList.toggle("dark-mode");

    if (body.classList.contains("dark-mode")) {
      localStorage.setItem("theme", "dark");
    } else {
      localStorage.setItem("theme", "light");
    }
  });
</script>


</body>

</html>
